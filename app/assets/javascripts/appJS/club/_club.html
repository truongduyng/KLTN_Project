<div class="row">
  <div class="col-lg-12 pull-right">
    <img class="coverimg" ng-src="{{club.cover_image}}" alt="anh dai dien">
    <h3 class="club_name">{{club.name}}</h3>
    <button class="btn btn-default leave_club_btn" ng-click="leave_club()" >Rời CLB</button>
    <i ng-show="current_user_is_admin()" class="fa fa-picture-o fa-2x cover-icon" nv-file-select uploader="uploader" ng-click="choose_cover()"></i>
    <input id="choosecover" type="file" nv-file-select uploader="uploader"/ style="display:none;">
  </div>
</div>

<section id="content">
  <div class="margintop10">
    <div class="row">

      <div class="col-lg-8">
        <tabset>
          <tab>
            <tab-heading>
            <i class="fa fa-pencil"></i> Thảo luận
          </tab-heading>

          <div class="write_status margintop10">

            <form novalidate name="postForm" class="post-form ng-pristine ng-valid">

              <div class="post-form-content">
                <textarea style="border:none;padding: 6px 12px;display:block;" placeholder="Nội dung bài viết" ng-model="clubpost.content" required></textarea>

                <div  class="post-form-images">
                  <span class="image" ng-repeat="photo in uploader_clubpost.queue">
                    <button ng-hide="photo.isUploading" ng-click="photo.remove()" aria-hidden="true" class="close" >&times;</button>
                    <div ng-thumb="{file: photo._file, height: 100, width:100}" ng-show="uploader_clubpost.isHTML5"></div>
                  </span>
                </div>
              </div>

              <div ng-show="uploader_clubpost.isUploading" style="margin: 0px 10px;margin-bottom: -10px;">
                <div class="progress">
                  <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" ng-style="{'width': uploader_clubpost.progress + '%'}" style="width: 0%;">
                    {{uploader_clubpost.progress}}
                  </div>
                </div>
              </div>

              <div class="post-form-bottom">
                <div style="margin: 5px 5px;">
                  <i class="fa fa-picture-o fa-2x" ng-click="onShowFileDialog()"></i>

                  <input style="display:none;" id="addImageInput" type="file" nv-file-select uploader="uploader_clubpost" multiple>

                  <button ng-disabled="postForm.$invalid" ng-click="onPostclubpost()" class="btn btn-primary" type="button"> Đăng </button>
                </div>
              </div>

            </form>

          </div>

          <div class="post margintop10" ng-repeat = "post in club.clubposts">
            <div style="height: 58px">
              <div class="pull-left">
                <img style="width: 40px;" ng-src="{{post.user.avatar}}" class="profile-picture" alt="">
              </div>
              <div class="pull-left marginleft5">
                <a ui-sref="trangCaNhan({username: post.user.username})">{{post.user.fullname}}</a><br>
                <a href="#">{{post.updated_at | date:'h:mm a, dd/mm/yyyy'}}</a>
              </div>
            </div>
            <div class="postcontent margintop10">
              <p>{{post.content}}</p>
            </div>
            <div class="detail-post-images" style="margin-top: 20px;">
              <a ng-click="showImage(photo, post.photos)" ng-repeat="photo in post.photos"><img ng-src="{{photo.url}}" height="50px"></a>
            </div>

            <div class="likes">
            <span tooltip="Thích" ng-hide="post.isLiked" class="fa fa-thumbs-up like-icon" ng-click="likeclubPost(post)"></span>
              <span tooltip="Bỏ thích" ng-show="post.isLiked" class="fa fa-thumbs-down unlike-icon" ng-click="unlikeclubPost(post)">
              </span>

              <a  ng-mouseenter="getKFirstLikes()" tooltip-html-unsafe="{{likesHtml}}" ng-click="showAllLikes()" style="cursor: pointer; margin-left: 10px;" >{{post.like_count}} người thích</a>

            </div>
            <section id="listComments" ng-include="'appJS/chiTietBaiViet/_listComments.html'"></section>

          </div>

        </tab>

        <tab ng-show="current_user_is_admin()">
          <tab-heading>
          Chỉnh sửa
        </tab-heading>

        <div class="row padding10">
          <div class="col-sm-3">
            <label>Tên CLB*</label>
          </div>
          <div class="col-sm-9">
            <input name="name" type="text" class="form-control" data-ng-model="club_update.name" required>
          </div>
        </div>
        <div class="row padding10">
          <div class="col-sm-3">
            <label>Mô tả</label>
          </div>

          <div class="col-sm-9">
            <textarea  rows="4" cols="50" class="form-control" data-ng-model="club_update.description">
            </textarea>
          </div>
        </div>
        <div class="pull-right margintop20">
          <button class="btn btn-primary" ng-click="update_club()">Lưu</button>
        </div>
      </tab>

    </tabset>
  </div>


  <div class="col-lg-4">

    <div>
      <label>Thành viên</label>
      <label class="pull-right">{{club.members.length}}</label>

      <input id="user_find" ng-show="current_user_is_admin()" type="text" placeholder=" + them thanh vien..." class="form-control" ng-model="user_find" ng-change="find_user()">

      <ul ng-show="show_recommend_user()" class="list_recommend">
        <li ng-repeat="user in users_list" ng-click= "add_to_members(user)">{{user.fullname}}</li>
      </ul>

      <ul class="list_user_choosen margintop10">
        <li class="member_list" ng-repeat="member in club.members">
          <span ng-show="current_user_is_admin()" class="dropdown" dropdown on-toggle="toggled(open)" >
            <a href class="dropdown-toggle" dropdown-toggle>
              <i class="fa fa fa-cog" style="color: white;"></i>
            </a>
            <ul class="dropdown-menu" style="z-index: 5; color: black;">
              <li>
                <i class="fa fa-user-times" ng-click= "remove_member(member)"> Xóa thành viên</i>
              </li>
              <li ng-hide = 'member_is_admin(member.id.$oid)'>
                <i class="fa fa-user-secret" ng-click= "make_admin(member)"> Chỉ định là quản trị</i>
              </li>
              <li ng-show = 'member_is_admin(member.id.$oid)'>
                <i class="fa fa-user" ng-click= "remove_admin(member)"> Chỉ định là thành viên</i>
              </li>
            </ul>
          </span>
          <!-- <img style="width: 40px;" fallback-src="sportaLogo" ng-src="{{member.avatar|logo}}" class="profile-picture"> -->
          {{member.fullname}}
        </li>
      </ul>
    </div>

    <div class="about" style="width: 100%; float: left;">
      <hr>
      <label>Mô tả</label>
      <p>{{club.description}}</p>
    </div>
  </div>

</div>
</div>
</section>

<script type="text/ng-template" id="showImageModal.html">
  <div class="modal-body my-modal-image">
    <img ng-src="{{photo.url}}" width="100%" height="100%">

    <span left-arrow-pressed="previous()" ng-click="previous()" u="arrowleft" class="jssora02l" style="top: 50%; left: 8px;">
    </span>

    <span right-arrow-pressed="next()"  ng-click="next()" u="arrowright" class="jssora02r" style="top: 50%; right: 8px">
    </span>
  </div>
</script>

<script type="text/javascript">
  autosize(document.querySelectorAll('textarea'));
</script>